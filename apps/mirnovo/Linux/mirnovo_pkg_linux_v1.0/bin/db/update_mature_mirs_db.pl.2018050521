#!/usr/bin/perl

use strict;
use warnings;

my @input_genomes = @ARGV;


foreach(@input_genomes){
	my $genome = $_;


	my $species_db_id = "$genome\_mature.fa";

	open(OUT,">$species_db_id");
	
	open(FH,'mature.fa');

	my $found_seq = 'FALSE';
	my $mature_seq = "";


	while(my $mir_line = <FH>){
	

		if($mir_line =~ /^>/){	
			if($mature_seq ne ""){
				print OUT "$mature_seq";
				$found_seq = 'FALSE';
				$mature_seq = "";
			}

			if($mir_line =~ /^>$genome/){

				print OUT "$mir_line";
				$found_seq = 'TRUE';
				next;
			}
		} elsif($found_seq eq 'TRUE'){
			$mature_seq .= $mir_line;
		} #elsif($mature_seq ne ""){
		#	print OUT $mature_seq;
		#	$found_seq = 'FALSE';
		#	$mature_seq = "";
		#}
	}

	close(OUT);
	close(FH);



	# create blastable database for current genome:
	my $db_name = "$genome.fasta.mature";
	`./makeblastdb -in $species_db_id -dbtype nucl -title $db_name -out $db_name`;
}
